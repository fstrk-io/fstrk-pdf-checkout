<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Счет на оплату № {{ order.number }} от {{ order.created|russian_date }}</title>
  <style>
    * {
      font-family: Arial, Helvetica, sans-serif;
      box-sizing: border-box;
    }

    html, body {
      font-size: 10px;
      color: black;
    }

    hr {
      height: 3px;
      background-color: black;
      margin: 16px 0;
    }

    h1 {
      font-size: 20px;
    }

    h2 {
      font-size: 16px;
    }

    p {
      margin: 20px 0;
    }

    table {
      width: 100%;
      margin: 16px 0;
    }

    th, td {
      border: 1px solid black;
      padding: 4px;
    }

    table.no-border th,
    table.no-border td {
      border: 0;
    }

    table td.border-bottom {
      border-bottom: 1px solid black;
      width: 30%;
    }

    .bold {
      font-weight: bold;
    }

    .small {
      font-size: 8px;
    }

    .pull-right {
      text-align: right;
    }

    .pull-center {
      text-align: center;
    }
  </style>
</head>
<body>
<table>
  <tr>
    <td colspan="2" rowspan="2">{{ customer.bank.name }}<br/><br/>Банк получателя</td>
    <td>БИК</td>
    <td>{{ customer.bank.bik }}</td>
  </tr>
  <tr>
    <td>Сч. №<br></td>
    <td>{{ customer.bank.kor_schet }}</td>
  </tr>
  <tr>
    <td>ИНН {{ customer.inn }}</td>
    <td>КПП {{ customer.kpp }}</td>
    <td rowspan="2">Сч. №</td>
    <td rowspan="2">{{ customer.rasch_schet }}</td>
  </tr>
  <tr>
    <td colspan="2">{{ customer.name }}<br><br>Получатель</td>
  </tr>
</table>
<h1>Счет на оплату № {{ order.number }} от {{ order.created|russian_date }}</h1>
<h2>
  В платежном поручении в назначении платежа указывать: «Оплата по Договор
  поставки No {{ order.number }} от {{ order.created|russian_date }}г.»!
</h2>
<hr/>
<table class="no-border">
  <tr>
    <td>Поставщик:</td>
    <td class="bold">ИНН {{ customer.inn }} КПП {{ customer.kpp }} {{ customer.name }}, {{ customer.address }}</td>
  </tr>
  <tr>
    <td>Покупатель:</td>
    <td class="bold">{{ shure.rekveziti }}</td>
  </tr>
  <tr>
    <td>Основание:</td>
    <td class="bold">Договор поставки No {{ order.number }} от {{ order.created|russian_date }}</td>
  </tr>
</table>
<table>
  <thead>
  <tr>
    <th>№</th>
    <th>Код</th>
    <th>Товар</th>
    <th>Кол-во</th>
    <th>Ед.</th>
    <th>Цена</th>
    <th>Сумма</th>
  </tr>
  </thead>
  <tbody>
  {% for object in products %}
  <tr>
    <td class="pull-center">{{ loop.index }}</td>
    <td>{{ object.detail.name }}</td>
    <td>{{ object.detail.detail }}</td>
    <td class="pull-right">{{ object.quantity }}</td>
    <td>шт.</td>
    <td class="pull-right">{{ '%0.2f'| format((object.price / object.quantity)|float) }}</td>
    <td class="pull-right">{{ '%0.2f'| format(object.price|float) }}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>
<hr/>

{% set total_sum = products|sum(attribute='price') %}
{% set total_sum_rounded = '%0.2f'| format(total_sum|float) %}%}
{% set nds_rounded = '%0.2f'| format((total_sum*0.2)|float) %}


<div class="bold pull-right">
  <p>
    Итого: {{ total_sum_rounded }} руб.<br/>
    В том числе НДС: {{ nds_rounded }} руб.
  </p>
</div>
<div>
  <p>
    Всего наименований {{ products|sum(attribute='quantity') }}, на сумму {{ total_sum_rounded }} руб.<br/>
    <strong>{{ total_sum|num2words|capitalize }} </strong>
  </p>
</div>
<hr/>
<table class="no-border">
  <tr>
    <td rowspan="2">Руководитель</td>
    <td class="border-bottom"></td>
    <td>/ {{ shure.rukovoditel.name }} /</td>
  </tr>
  <tr>
    <td></td>
    <td class="small">На основании {{ shure.rukovoditel.doverennost }}</td>
  </tr>
  <tr>
    <td rowspan="2">Бухгалтер</td>
    <td class="border-bottom"></td>
    <td>/ {{ shure.buhgalter.name }} /</td>
  </tr>
  <tr>
    <td></td>
    <td class="small">На основании {{ shure.buhgalter.doverennost }}</td>
  </tr>
  <tr>
    <td rowspan="2">Менеджер</td>
    <td class="border-bottom"></td>
    <td>/ {{ shure.manager.name }} /</td>
  </tr>
  <tr>
    <td></td>
    <td class="small">
      {% if shure.manager.doverennost %}На основании {{ shure.manager.doverennost }}{% endif %}
    </td>
  </tr>
</table>
</body>
</html>
